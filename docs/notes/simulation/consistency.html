<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.442">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-05-24">

<title>Jaehyun Song, Ph.D.&nbsp;- 一致性・不偏性・効率性</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<link href="../../imgs/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BCE61P2YP7"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-BCE61P2YP7', { 'anonymize_ip': true});
</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Jaehyun Song, Ph.D.&nbsp;- 一致性・不偏性・効率性">
<meta property="og:description" content="Jaehyun Song's personal homepage">
<meta property="og:image" content="https://www.jaysong.net/notes/simulation/imgs/favicon.png">
<meta property="og:site-name" content="Jaehyun Song, Ph.D.">
<meta name="twitter:title" content="Jaehyun Song, Ph.D.&nbsp;- 一致性・不偏性・効率性">
<meta name="twitter:description" content="Jaehyun Song's personal homepage">
<meta name="twitter:image" content="https://www.jaysong.net/notes/simulation/imgs/favicon.png">
<meta name="twitter:creator" content="@Tintstyle">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jaehyun Song, Ph.D.</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../cv/index.html">CV</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research/index.html">Research</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching/index.html">Teaching</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../seminar/index.html">Seminar</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../software/index.html">Software</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes/index.html">Notes</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorial/index.html">Tutorials</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Tintstyle"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.facebook.com/tintstyle"><i class="bi bi-facebook" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/tintstyle/"><i class="bi bi-instagram" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/JaehyunSong"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://scholar.google.com/citations?user=8a-NxjkAAAAJ&amp;hl=ja"><i class="bi bi-mortarboard-fill" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://researchmap.jp/jaysong"><i class="bi bi-map" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">一致性・不偏性・効率性</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">作成・改訂</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 24, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>　ここでは統計学を勉強する上でよく混同される一致性と不偏性について解説します。</p>
<section id="一致性とは" class="level2">
<h2 class="anchored" data-anchor-id="一致性とは">一致性とは</h2>
<p>　一致性はサンプルサイズが大きくなると、推定値が母数へ収束することを意味します。たとえば、<span class="math inline">\(\mu = 0\)</span>、<span class="math inline">\(\sigma = 100\)</span>の正規分布から独立的に抽出された<span class="math inline">\(n\)</span>個の確率変数<span class="math inline">\(X\)</span>があるとします。つまり、以下のような状況を考えます。</p>
<p><span class="math display">\[
X_1, X_2, X_3, ..., X_n \overset{\text{iid}}{\sim} N(0, 100).
\]</span></p>
<p>　ただし、ここでは<span class="math inline">\(\mu = 0\)</span>、<span class="math inline">\(\sigma = 100\)</span>を仮定しましたが、実際において私たちは<span class="math inline">\(\mu\)</span>と<span class="math inline">\(\sigma\)</span>の値は分かりません。たとえば、手元に男女100人の身長データがあっても、日本人全体の身長の平均値と分散は分かりません。したがって、私たちは手元にあるこの<span class="math inline">\(X\)</span>のみを用いて、未知である母集団の特徴を推論する必要があります。手元の<span class="math inline">\(X\)</span>から母集団における平均値（<span class="math inline">\(\mu\)</span>）を推定する際によく使われるが平均値（<span class="math inline">\(\bar{X}\)</span>）です。</p>
<p>　たとえば、<span class="math inline">\(n = 5\)</span>の場合を考えてみましょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">19861009</span>) <span class="co"># 乱数のseedを指定</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">100</span>) <span class="co"># N(0, 100)から乱数を5個抽出する</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(X1) <span class="co"># 抽出された乱数を出力する</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -195.662813  153.088455   25.989905   -3.071453  -53.218536</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X1) <span class="co"># 抽出された乱数の平均値を出力する</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.57489</code></pre>
</div>
</div>
<p>　<span class="math inline">\(n = 5\)</span>の場合、<span class="math inline">\(\bar{X}\)</span>は-14.5748884です。それでは<span class="math inline">\(n = 100\)</span>ならどうでしょうか。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">100</span>) <span class="co"># N(0, 100)から乱数を100個抽出する</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(X2) <span class="co"># 抽出された乱数を出力する</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]  -12.513448   16.473814  -55.827125  -86.033925  196.563039  -59.660676
  [7]  178.879309  -95.615549 -117.455299   53.094037   80.033960  -47.082599
 [13] -102.146620   89.866926   -7.909525  -31.347797   30.952894  107.081687
 [19] -195.426684  -71.759205   48.629528  116.743532   51.594264 -211.544831
 [25]  160.766456  308.931296   36.696450   78.402401   13.495426  -19.456266
 [31] -120.529780    6.163411  -24.332314  138.872863  -30.410003   39.268512
 [37] -124.424084   59.200185   54.027469   72.515763 -178.219784 -179.507844
 [43]   47.350023  -52.366831   98.083261  -44.570705  217.776695   62.598027
 [49]  -90.665200  103.918722 -142.114845   58.524963  -33.849776   75.790091
 [55]  -89.727866    5.718650  -14.870296  -42.457583  -39.518473   49.421506
 [61]   17.351046  -39.949024  -62.180725  -21.830242   42.782942   35.902584
 [67]  -28.100441  -86.049005   37.312739  -43.398827 -288.436043   40.767558
 [73]   18.953100   -4.163539   59.720674   97.730085   48.131342  -83.222430
 [79]   71.003268  181.770553   82.021292  -59.789360   61.338302 -154.959971
 [85] -173.761830 -177.086379  147.810801  -58.044487  140.592706   32.867267
 [91]   60.883589  -50.408130 -124.858910   32.480463 -104.253371  -26.842073
 [97]  -76.278107  -92.971755   16.245089  -78.430475</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X2) <span class="co"># 抽出された乱数の平均値を出力する</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.732595</code></pre>
</div>
</div>
<p>　<span class="math inline">\(n = 100\)</span>の場合の<span class="math inline">\(\bar{X}\)</span>は-2.732595ですね。最後に、<span class="math inline">\(n = 10000\)</span>ならどうでしょうか。このサンプルを出力するのはあまりにも結果が長くなるので、ここでは平均値だけを出力します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">100</span>) <span class="co"># N(0, 100)から乱数を1万個抽出する</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X3) <span class="co"># 抽出された乱数の平均値を出力する</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9447894</code></pre>
</div>
</div>
<p>　<span class="math inline">\(n = 10000\)</span>の場合の<span class="math inline">\(\bar{X}\)</span>は-0.9447894ですね。このように<span class="math inline">\(n\)</span>が大きくなると、<span class="math inline">\(\bar{X}\)</span>は母集団の平均値（ここでは<span class="math inline">\(\mu = 0\)</span>）へ近づきます。このようにサンプルサイズが大きくなると推定値が母数へ近づくことを「<strong>一致性</strong> (consistency)」と呼びます。この例だと、「標本の平均値（<span class="math inline">\(\bar{X}\)</span>）は母集団の平均値（<span class="math inline">\(\mu\)</span>）の一致推定量である」と言えます。これは<span class="math inline">\(\bar{X} \overset{p}{\rightarrow} \mu\)</span>と表記されます。より一般的に書くと推定値<span class="math inline">\(\hat{\theta}\)</span>が母数<span class="math inline">\(\theta\)</span>の一致推定量である場合、<span class="math inline">\(\hat{\theta} \overset{p}{\rightarrow} \theta\)</span>と表記します。</p>
<p>　この表記は大数の弱法則とも共通しますが、実際、一致性は大数の弱法則によって成り立ちます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>X_bar_vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">1000</span>)     <span class="co"># 長さ1000の空ベクトルを作成</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {            <span class="co"># iを1から1000へ増やしながら反復</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  temp_vec <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(i, <span class="dv">0</span>, <span class="dv">100</span>) <span class="co"># N(0, 100)からi個の乱数を抽出し、temp_vecに格納</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># temp_vecの平均値をX_bar_vecのi番目要素として格納</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  X_bar_vec[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp_vec)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 可視化</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="at">y =</span> X_bar_vec)) <span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"n"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(theta)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="consistency_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>　<span class="math inline">\(n\)</span>を大きくすることによって<span class="math inline">\(\bar{X}\)</span>が<span class="math inline">\(\mu (=0)\)</span>へ近づくことが分かります。この<span class="math inline">\(n\)</span>を無限にすると (<span class="math inline">\(n \rightarrow \infty\)</span>)、<span class="math inline">\(\bar{X} = \mu\)</span>になるでしょう。したがって、<span class="math inline">\(\bar{X}\)</span>は<span class="math inline">\(\mu\)</span>の一致推定量となります。</p>
</section>
<section id="不偏性とは" class="level2">
<h2 class="anchored" data-anchor-id="不偏性とは">不偏性とは</h2>
<p>　一致性と混同されやすい概念が「不偏性（unbiasedness）」です。これは推定値<span class="math inline">\(\hat{\theta}\)</span>の<strong>期待値</strong>が母数<span class="math inline">\(\theta\)</span>と一致することを意味します。数式で表すと<span class="math inline">\(\mathbb{E}[\hat{\theta}] = \theta\)</span>であり、一致性と違って、サンプルサイズ（<span class="math inline">\(n\)</span>）とは無関係な性質です。</p>
<p>　たとえば、<span class="math inline">\(\mu = 0\)</span>、<span class="math inline">\(\sigma = 100\)</span>の正規分布から独立的に5個の値を抽出します（<span class="math inline">\(n = 5\)</span>）。そして、この5個の値の平均値（<span class="math inline">\(\bar{X}\)</span>）を計算します。この作業を1万回繰り返したいと思います。</p>
<div class="cell" data-hash="consistency_cache/html/unnamed-chunk-5_5774f71bfbf76f64aed960d8bbe9a11d">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Trial =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">X1    =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">X2    =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">X3    =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">X4    =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">X5    =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Trial    X1     X2     X3     X4     X5
  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     1 -91.6  -20.6   42.1 -28.8  -134. 
2     2 -22.7 -204.    66.6 134.     66.2
3     3 -26.1   89.4   37.4 146.   -108. 
4     4 -27.9  -68.9   94.8  39.6   -50.7
5     5  48.4  -65.0  110.  -23.1   -17.2
6     6  99.2  -29.2 -142.   -9.03   39.9</code></pre>
</div>
</div>
<p>　それでは<span class="math inline">\(X_1\)</span>から<span class="math inline">\(X_5\)</span>までの平均値を計算します。</p>
<div class="cell" data-hash="consistency_cache/html/unnamed-chunk-6_40e8516d491581d7e4157d1f16e8226d">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X_bar =</span> (X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4 <span class="sc">+</span> X5) <span class="sc">/</span> <span class="dv">5</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  Trial    X1     X2     X3     X4     X5  X_bar
  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     1 -91.6  -20.6   42.1 -28.8  -134.  -46.5 
2     2 -22.7 -204.    66.6 134.     66.2   8.13
3     3 -26.1   89.4   37.4 146.   -108.   27.9 
4     4 -27.9  -68.9   94.8  39.6   -50.7  -2.62
5     5  48.4  -65.0  110.  -23.1   -17.2  10.6 
6     6  99.2  -29.2 -142.   -9.03   39.9  -8.18</code></pre>
</div>
</div>
<p>　この<span class="math inline">\(\bar{X}\)</span>の平均値（<span class="math inline">\(\bar{\bar{X}}\)</span>）、つまり<span class="math inline">\(\mathbb{E}[\bar{X}]\)</span>はどうでしょうか。厳密には<span class="math inline">\(\mathbb{E}[\bar{X}]\)</span>ではありませんが、試行回数が無限回となると<span class="math inline">\(\mathbb{E}[\bar{X}]\)</span>となります。試行回数1万は十分多いと考えられるので、期待値に近い結果が得られると考えられます。</p>
<div class="cell" data-hash="consistency_cache/html/unnamed-chunk-7_0d0f1e28939c4c748b1dfd80bdcfaeb7">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>X_bar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09291811</code></pre>
</div>
</div>
<p>　<span class="math inline">\(\mathbb{E}[\bar{X}]\)</span>は0.0929181であり、ほぼ0であることが分かります。この0が母数（<span class="math inline">\(\mu\)</span>）であり、<span class="math inline">\(\mathbb{E}[\bar{X}] = \mu\)</span>の関係が成り立つことが分かります。したがって、<span class="math inline">\(\bar{X}\)</span>は<span class="math inline">\(\mu\)</span>の不偏推定量となります。</p>
<p>　不偏推定量は複数存在することもあります。ここまで見てきました標本平均<span class="math inline">\(\bar{X}\)</span>も<span class="math inline">\(\mu\)</span>の不偏推定量の一つに過ぎません。たとえば、以下のような推定量を考えてみましょう。</p>
<p><span class="math display">\[
\begin{eqnarray}
  Y_1 &amp; = X_3 \\
  Y_2 &amp; = \frac{1}{9}(X_1 + 2 \cdot X_2 + 3 \cdot X_3 + 2 \cdot X_4 + X+5).
\end{eqnarray}
\]</span></p>
<div class="cell" data-hash="consistency_cache/html/unnamed-chunk-8_5d092045d068f0be6bb6d375ebc38c39">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y1 =</span> X3,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Y2 =</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">9</span>) <span class="sc">*</span> (X1 <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> X2 <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> X3 <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> X4 <span class="sc">+</span> X5))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  Trial    X1     X2     X3     X4     X5  X_bar     Y1    Y2
  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1     1 -91.6  -20.6   42.1 -28.8  -134.  -46.5    42.1 -22.0
2     2 -22.7 -204.    66.6 134.     66.2   8.13   66.6  11.6
3     3 -26.1   89.4   37.4 146.   -108.   27.9    37.4  50.0
4     4 -27.9  -68.9   94.8  39.6   -50.7  -2.62   94.8  16.4
5     5  48.4  -65.0  110.  -23.1   -17.2  10.6   110.   20.6
6     6  99.2  -29.2 -142.   -9.03   39.9  -8.18 -142.  -40.3</code></pre>
</div>
</div>
<p>　それでは<span class="math inline">\(\mathbb{E}[Y_1]\)</span>と<span class="math inline">\(\mathbb{E}[Y_2]\)</span>を計算してみましょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>Y1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5527504</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>Y2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1050386</code></pre>
</div>
</div>
<p>　それぞれ0.5527504と0.1050386の結果が得られており、こちらも<span class="math inline">\(\mu\)</span>に非常に近いことが分かります。標本平均以外にも母平均の不偏推定量がいくらでもあり得ることが分かります。</p>
<p>　しかし、なぜ<span class="math inline">\(\mu\)</span>の不偏推定量として<span class="math inline">\(\bar{X}\)</span>が使われているのでしょうか。それは<span class="math inline">\(\bar{X}\)</span>が最も効率的な推定量であるからです。</p>
<hr>
</section>
<section id="効率性とは" class="level2">
<h2 class="anchored" data-anchor-id="効率性とは">効率性とは</h2>
<p>　不偏推定量の中で一つ選ぶとしたら「効率性（efficiency）」というものを基準とします。同じ不偏推定量であれば、精度の高い推定量、つまり分散が小さい推定量がいいでしょう。この精度の良さが「効率性」です。他にも、「有効性」と呼ばれる場合もあります。</p>
<p>　効率性の最も良い推定量のことを有効推定量と呼びます。この効率性は簡単にいうと推定量の分散を意味します。これまで<span class="math inline">\(\mu\)</span>の不偏推定量として<span class="math inline">\(\bar{X}\)</span>、<span class="math inline">\(Y_1\)</span>、<span class="math inline">\(Y_2\)</span>を見てきました。これら3つの不偏推定量の効率性は<span class="math inline">\(V[\bar{X}]\)</span>、<span class="math inline">\(V[Y_1]\)</span>、<span class="math inline">\(V[Y_2]\)</span>を用いて調べることが可能です。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(df<span class="sc">$</span>X_bar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2004.154</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(df<span class="sc">$</span>Y1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9974.554</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(df<span class="sc">$</span>Y2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2359.181</code></pre>
</div>
</div>
<p>　それぞれの分散は2004.1535382、9974.5536133、2359.1813379であり、<span class="math inline">\(V[\bar{X}]\)</span>が最も分散が小さい、つまり最も効率的な推定量であることが分かります。<span class="math inline">\(\bar{X}\)</span>は一致推定量でありながら不偏推定量であり、そして最も効率的な<span class="math inline">\(\mu\)</span>の推定量となります。</p>
<hr>
</section>
<section id="一致推定量不偏推定量" class="level2">
<h2 class="anchored" data-anchor-id="一致推定量不偏推定量">一致推定量=不偏推定量?</h2>
<p>　先ほどの標本平均は一致推定量でありながら、不偏推定量でした。しかし、世の中には一致推定量でありながら、不偏推定量ではない推定量が存在します。その代表的な例が標本分散（<span class="math inline">\(s^2\)</span>）です。標本分散（<span class="math inline">\(s^2\)</span>）は母集団における分散（<span class="math inline">\(\sigma^2\)</span>）の一致推定量ですが、不偏推定量ではありません。</p>
<p>　たとえば、<span class="math inline">\(\mu = 0\)</span>、<span class="math inline">\(\sigma = 100\)</span>の正規分布から独立的に1000万個の乱数を生成したとします。この場合、母分散（<span class="math inline">\(\sigma^2\)</span>）は10000となります。そして、この1000万個の値の標本分散（<span class="math inline">\(s^2\)</span>）と不偏分散（<span class="math inline">\(\hat{\sigma}^2\)</span>）を計算します。ちなみに、Rの<code>var()</code>は不偏分散を計算するため、標本分散を求めるためには不偏分散に<span class="math inline">\(\frac{n-1}{n}\)</span>を掛ける必要があります。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000000</span>, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X) <span class="sc">*</span> ((<span class="fu">length</span>(X) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">length</span>(X)) <span class="co"># 標本分散</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9996.52</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X) <span class="co"># 不偏分散</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9996.521</code></pre>
</div>
</div>
<p>　どれも母分散に非常に近い値が得られており、<span class="math inline">\(n\)</span>を無限にすると母分散に一致すると予想されます。したがって、<span class="math inline">\(s^2 \overset{p}{\rightarrow} \sigma^2\)</span>、<span class="math inline">\(\hat{\sigma}^2 \overset{p}{\rightarrow} \sigma^2\)</span>であり、どれも一致推定量であることが分かります。</p>
<div class="cell" data-hash="consistency_cache/html/unnamed-chunk-12_532f1780cbd09e96e58384cf82e2dc21">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Trial =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">X1    =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">X2    =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">X3    =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">X4    =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">X5    =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> <span class="co"># 行単位の演算</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">S_2         =</span> <span class="fu">var</span>(<span class="fu">c</span>(X1, X2, X3, X4, X5)) <span class="sc">*</span> (<span class="dv">4</span><span class="sc">/</span><span class="dv">5</span>), <span class="co"># 各試行における標本分散</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Sigma_hat_2 =</span> <span class="fu">var</span>(<span class="fu">c</span>(X1, X2, X3, X4, X5)))         <span class="co"># 各試行における不偏分散</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Rowwise: 
  Trial     X1    X2    X3    X4     X5    S_2 Sigma_hat_2
  &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;
1     1  -59.1  29.6  44.2 -70.3  -14.7  2097.       2621.
2     2  149.   37.8 -25.9 -19.8  145.   5847.       7308.
3     3   47.6 158.  -20.8 123.  -219.  17846.      22307.
4     4 -175.  -17.2 138.   12.2  -93.2 11005.      13756.
5     5  137.  173.   53.6 -33.2   29.7  5521.       6902.
6     6  118.   28.8  40.6 -15.6   76.7  2021.       2526.</code></pre>
</div>
</div>
<p>　それでは<span class="math inline">\(s^2\)</span>と<span class="math inline">\(\hat{\sigma}^2\)</span>の平均値（<span class="math inline">\(\simeq\)</span>期待値）を計算してみましょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>S_2) <span class="co"># 標本分散の期待値</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8067.114</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>Sigma_hat_2) <span class="co"># 不偏分散の期待値</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10083.89</code></pre>
</div>
</div>
<p>　標本分散の期待値は約8000で、母分散の<span class="math inline">\(\frac{n-1}{n}\)</span>、つまり<span class="math inline">\(\frac{4}{5}\)</span>となります。一方、不偏分散の場合期待値が母分散に非常に近いことが分かります。したがって、不偏分散は一致性と不偏性があり、標本分散は一致性のみあることが分かります。</p>
<p>　逆に不偏推定量でありながら一致推定量ではない推定量も存在します。たとえば、以下のような例を考えてみましょう。</p>
<ol type="1">
<li><span class="math inline">\(X_1, X_2, X_3, ..., X_n \overset{\text{iid}}{\sim} N(0, 100)\)</span>とする</li>
<li><span class="math inline">\(|X_i| = \max{(|X_1|, |X_2|, |X_3|, ..., |X_i|, ..., |X_n|)}\)</span>の場合、<span class="math inline">\(\hat{\theta} = X_i\)</span></li>
</ol>
<p>　要するに、絶対値の最も高かった値を<span class="math inline">\(\theta\)</span>の推定量（<span class="math inline">\(\hat{\theta}\)</span>）として用いることを意味します。この場合、<span class="math inline">\(\hat{\theta}\)</span>は一致推定量でしょうか。<span class="math inline">\(n\)</span>を1から1000まで増やしながら確認してみましょう。</p>
<div class="cell" data-hash="consistency_cache/html/unnamed-chunk-14_98f88952c06dab8d82f7a0bd9fee6ee2">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>theta_hat_vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">1000</span>) <span class="co"># 長さ1000の空ベクトルを作成</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {            <span class="co"># iを1から1000へ増やしながら反復</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  temp_vec <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(i, <span class="dv">0</span>, <span class="dv">100</span>) <span class="co"># N(0, 100)からi個の乱数を抽出し、temp_vecに格納</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># temp_vecの中で最も絶対値の高い値はtheta_hat_vecのi番目要素として格納</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  theta_hat_vec[i] <span class="ot">&lt;-</span> temp_vec[<span class="fu">abs</span>(temp_vec) <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">abs</span>(temp_vec))]</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 可視化</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="at">y =</span> theta_hat_vec)) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"n"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(theta)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="consistency_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>　このように<span class="math inline">\(n\)</span>をいくら増やしても<span class="math inline">\(\hat{\theta}\)</span>は母数である0へ収束しないことが分かります。つまり、この推定量は一致推定量ではありません。それでは、この推定量は不偏推定量でしょうか。ここでは話を単純にするために<span class="math inline">\(n = 3\)</span>の例を考えてみましょう。不偏性はサンプルサイズ（<span class="math inline">\(n\)</span>）と無関係ですので、これでも問題ないでしょう。試行数は100万とします。</p>
<div class="cell" data-hash="consistency_cache/html/unnamed-chunk-15_ad46a8d05f30e65104e2d6188e23682f">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># シミュレーション用のデータを作成</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Trial =</span> <span class="fu">paste0</span>(<span class="st">"Trial"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">1000000</span>),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">X1    =</span> <span class="fu">rnorm</span>(<span class="dv">1000000</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">X2    =</span> <span class="fu">rnorm</span>(<span class="dv">1000000</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">X3    =</span> <span class="fu">rnorm</span>(<span class="dv">1000000</span>, <span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X1, X2, X3の中で絶対値の最も高い値をTheta_Hatとする</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Theta_Hat =</span> <span class="fu">case_when</span>(<span class="fu">abs</span>(X1) <span class="sc">&gt;</span> <span class="fu">abs</span>(X2) <span class="sc">&amp;</span> <span class="fu">abs</span>(X2) <span class="sc">&gt;</span> <span class="fu">abs</span>(X3) <span class="sc">~</span> X1,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">abs</span>(X2) <span class="sc">&gt;</span> <span class="fu">abs</span>(X3)                     <span class="sc">~</span> X2,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                               <span class="cn">TRUE</span>                                  <span class="sc">~</span> X3)) </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df) <span class="co"># dfの中身を確認する</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Trial       X1    X2     X3 Theta_Hat
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
1 Trial1   48.6   73.3  -70.9      73.3
2 Trial2 -377.   152.  -182.     -182. 
3 Trial3  105.   -46.6   90.8      90.8
4 Trial4   52.5  -83.3  -66.8     -83.3
5 Trial5 -121.   -56.9   83.9      83.9
6 Trial6    8.23  51.4   92.5      92.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dfのTheta_Hat列の期待値（平均値）を計算する。</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>Theta_Hat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.02872534</code></pre>
</div>
</div>
<p>　非常に0に近い結果が得られており、これはほぼ<span class="math inline">\(\mu\)</span>と同じ値となります。施行数が無限回になると、<span class="math inline">\(\mathbb{E}[\hat{\theta}]\)</span>は<span class="math inline">\(\mu\)</span>と一致していくだろうと考えられます。</p>
<p>　我々が教科書でよく見る推定量は一般的に一致性と不偏性を同時に満たす推定量が多いでしょう。しかし、例外も常に存在します。標本分散もその一つの例です。他にも、最尤推定法から得られた分散の推定量は一致推定量ではあるものの、不偏推定量ではないことが知られています。</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/www\.jaysong\.net\//);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, Jaehyun Song. Powered by <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>