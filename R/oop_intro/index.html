<!DOCTYPE html>
<html lang="ja-jp">
    <head>
        <script defer src="/fa/fontawesome-all.js"></script>
        

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Rによるオブジェクト指向プログラミング入門</title>
        
        <style>

    html body {
        font-family: 'Noto Sans JP', sans-serif;
        background-color: white;
    }

    :root {
        --accent: darkred;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="https://www.jaysong.net/css/main.css">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto%20Sans%20JP">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/R.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/php.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/html.min.js"></script>
    
    <script>hljs.initHighlightingOnLoad();</script>






<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.76.5" />
        

        
            <script async src="https://www.googletagmanager.com/gtag/js?id=UA-96999602-1"></script>
            <script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments)};
              gtag('js', new Date());
              gtag('config', 'UA-96999602-1');
              gtag('set', {'user_id': 'USER_ID'});
            </script>

            <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-96999602-1', 'auto');
                ga('send', 'pageview');
            </script>
        

        <meta name="google-site-verification" content="QJouPRaPKBPU1jDp6VaBuFbVV5imTI-Aazl_ScJwVgU" />

        
            <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        

    </head>

    <body>
        

        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#">Rによるオブジェクト指向プログラミング入門</a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="/about/">CV</a></li>
                            
                                <li><a href="/research/">Research</a></li>
                            
                                <li><a href="/teaching/">Teaching</a></li>
                            
                                <li><a href="/software/">Software</a></li>
                            
                                <li><a href="/notes/">Notes</a></li>
                            
                                <li><a href="/tutorial/">Tutorial</a></li>
                            
                        </ul>
                    
                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="mailto:jasong@mail.doshisha.ac.jp"><i class="far fa-envelope"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://twitter.com/Tintstyle/"><i class="fab fa-twitter"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.facebook.com/tintstyle"><i class="fab fa-facebook"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.instagram.com/tintstyle/"><i class="fab fa-instagram"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/JaehyunSong/"><i class="fab fa-github"></i></a></li>
                            
                        </ul>
                    
                </div>
            </div>
        </nav>


<main>

    <div>
        <h2><center>Rによるオブジェクト指向プログラミング入門</center></h2>
        <h5><center></center></h5>
        <center>
<a href="https://www.jaysong.net/tags/r"><kbd class="item-tag">R</kbd></a>

<a href="https://www.jaysong.net/tags/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0"><kbd class="item-tag">プログラミング</kbd></a>

</center>
    </div>

    <div align="start" class="content"><script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="まずは例から" class="section level1">
<h1>1. まずは例から</h1>
<pre class="r"><code>Vector1 &lt;- c(1, 5, 3, 7, 9, 12, 5, 4, 10, 1)
Vector2 &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;D&quot;, &quot;B&quot;, &quot;E&quot;, &quot;A&quot;, &quot;A&quot;, &quot;D&quot;, &quot;C&quot;, &quot;C&quot;)</code></pre>
<pre class="r"><code>summary(Vector1)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.00    3.25    5.00    5.70    8.50   12.00</code></pre>
<pre class="r"><code>summary(Vector2)</code></pre>
<pre><code>##    Length     Class      Mode 
##        10 character character</code></pre>
<p>同じ<code>summary()</code>関数ですが、中のデータのタイプによって動きが異なります。これがオブジェクト指向プログラミングにおいて「<strong>多態性</strong> (polymorphism)」と呼ばれる概念です。同じ関数でもデータ型、またはデータ構造に応じて異なる動きをすることです。ここでのデータ型やデータ構造を、OOPでは「<strong>クラス</strong> (class)」と呼びます。クラスは<code>class()</code>関数で確認することができます。</p>
<pre class="r"><code>class(Vector1)</code></pre>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<pre class="r"><code>class(Vector2)</code></pre>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p><code>Vector1</code>はnumeric、<code>Vector2</code>はcharacterです。もし、無理矢理に<code>Vector1</code>のクラスをcharacterに変えればどうなるでしょうか。クラスの変更は<code>class(オブジェクト名) &lt;- "クラス名"</code>でできます。一つのオブジェクトは複数のクラスが持てますが、これはOOPの「<strong>継承</strong> (inheritance)」概念に関係するので後で解説します。ここではまず、<code>Vector1</code>のクラスをcharacterにし、もう一回<code>summary()</code>を使ってみましょう。</p>
<pre class="r"><code>class(Vector1) &lt;- &quot;character&quot;
summary(Vector1)</code></pre>
<pre><code>##    Length     Class      Mode 
##        10 character character</code></pre>
<p>データの中身は変わっていませんが、<code>summary()</code>関数の動き方が変わりました。このように、Rで頻繁に使う<code>summary()</code>、<code>print()</code>、<code>plot()</code>などの関数は様々なクラスの対応しております。<code>lm()</code>関数を使った回帰分析の結果オブジェクトのクラス名は<code>lm</code>であり、その結果を見るためにも<code>summary()</code>関数を使います。他にも<code>plot(lmオブジェクト名)</code>をすると回帰診断の図が表示されます。これができないと、各クラスに応じた関数を作成する必要がありますね。numeric型専用の<code>numeric_print()</code>、character型専用の<code>character_print()</code>、lm型専用の<code>lm_plot()</code>など…、覚えなきゃいけない関数が増えてきます。ユーザー側でも大変ですが、コードを作成する側も大変です。実際、下の図<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>を見ると、プログラマーにとって最も大変な仕事は「名付け」であることが分かります。</p>
<p><img src="https://images.techhive.com/images/idge/imported/article/itw/2013/10/23/programmers_hardest_tasks-600x700-100521914-orig.jpg" /><!-- --></p>
<p>OOPの多態性にはこのような煩わしい仕事を軽減する機能があります。OOPにはここで紹介した多態性以外にも、「<strong>継承</strong> (inheritance)」、「<strong>カプセル化</strong> (encapsulation)」のような特徴があります。他にも人によっては「メッセージパッシング (message passing)」、「動的バインディング (dynamic binding)」などの特徴を述べたりしますが、詳しい話は専門書に譲り合いと思います。また、ここではRのS3クラスについて解説しますが、S3はカプセル化に対応しておりません。したがって、ここでは以下の概念について例と一緒に解説していきたいと思います。</p>
<ol style="list-style-type: decimal">
<li>オブジェクト (object)</li>
<li>クラス (class)</li>
<li>メソッド (method)</li>
<li>多態性 (polymorphism)　</li>
<li>継承 (inheritance)</li>
</ol>
<hr />
</div>
<div id="oopとは" class="section level1">
<h1>2. OOPとは</h1>
</div>
<div id="rにおけるoop" class="section level1">
<h1>3. RにおけるOOP</h1>
</div>
<div id="とりあえず作ってみる" class="section level1">
<h1>4. とりあえず作ってみる</h1>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ─ Attaching packages ──────────────────────────── tidyverse 1.3.0 ─</code></pre>
<pre><code>## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
## ✓ tibble  3.0.3     ✓ dplyr   1.0.2
## ✓ tidyr   1.1.1     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.5.0</code></pre>
<pre><code>## ─ Conflicts ────────────────────────────── tidyverse_conflicts() ─
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>My_Cor &lt;- function(x, y, x.name, y.name) {
    if (!is.numeric(x) | !is.numeric(y)) {
        stop(&quot;xまたはyがnumeric型ではありません。&quot;)
    }
    if (length(x) != length(y)) {
        stop(&quot;xとyは同じ長さでなかればなりません。&quot;)
    }
    if (!is.character(x.name) | !is.character(y.name)) {
        stop(&quot;x.nameまたはy.nameがcharacter型ではありません。&quot;)
    }
    
    data     &lt;- data.frame(x = x, y = y)
    var_name &lt;- c(x.name, y.name)
    cor      &lt;- cor(x, y)
    
    result   &lt;- list(data = data, var_name = var_name, cor = cor)
    
    class(result) &lt;- &quot;My_Cor_Object&quot;
    
    result
}

#My_Cor_Object &lt;- function(x) {
#  UseMethod(&quot;My_Cor_Object&quot;)
#}

plot.My_Cor_Object &lt;- function(data) {
    if (class(data) != &quot;My_Cor_Object&quot;) stop()
    
    plot(x = data[[&quot;data&quot;]]$x, y = data[[&quot;data&quot;]]$y,
         xlab = data[[&quot;var_name&quot;]][1], ylab = data[[&quot;var_name&quot;]][2],
         main = sprintf(&quot;相関係数 = %.3f&quot;, data[[&quot;cor&quot;]]))
}

summary.My_Cor_Object &lt;- function(data) {
    if (class(data) != &quot;My_Cor_Object&quot;) stop()
    
    cat(&quot;Mean of&quot;, data[[&quot;var_name&quot;]][1], &quot;:&quot;, 
        sprintf(&quot;%.3f&quot;, mean(data[[&quot;data&quot;]]$x)), &quot;\n&quot;)
    cat(&quot;Mean of&quot;, data[[&quot;var_name&quot;]][2], &quot;:&quot;, 
        sprintf(&quot;%.3f&quot;, mean(data[[&quot;data&quot;]]$y)), &quot;\n&quot;)
}

Cor_Obj &lt;- My_Cor(x      = rnorm(50, 170, 4), 
                  y      = rnorm(50, 160, 4), 
                  x.name = &quot;男子学生の身長&quot;, 
                  y.name = &quot;女性学生の身長&quot;)

plot(Cor_Obj)</code></pre>
<p><img src="/R/OOP_intro_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>summary(Cor_Obj)</code></pre>
<pre><code>## Mean of 男子学生の身長 : 169.608 
## Mean of 女性学生の身長 : 159.618</code></pre>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>図の出典は<a href="https://www.itworld.com/article/2833265/don-t-go-into-programming-if-you-don-t-have-a-good-thesaurus.html">IT WORLD</a>です (アクセス: 2020-05-21)。<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
</div>

</main>

        <footer>
            <p class="copyright text-muted" align = "center">© All rights reserved. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a>. Customized by <a href="https://www.jaysong.net">Jaehyun Song</a></p>
        </footer>

        

        
    </body>

</html>

